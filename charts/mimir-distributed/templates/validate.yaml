{{- $calculatedConfig := include "mimir.calculatedConfig" . | fromYaml }}

{{- if .Values.config }}
{{- fail "Top level 'config' is not allowed. In 'mimir.config', provide the configuration as a string that can contain template expressions. Alternatively, you can provide the configuration as an external secret." }}
{{- end }}

{{- if .Values.podDisruptionBudget }}
{{- fail "Top level 'podDisruptionBudget' is removed in favour of per component podDisruptionBudget" }}
{{- end }}

{{- if not ($calculatedConfig.activity_tracker).filepath }}
{{- fail "The 'activity_tracker.filepath' in 'mimir.config' should be set to a path that is on a writeable volume. For example: '/data/metrics-activity.log'." }}
{{- end }}

